<!DOCTYPE html>
<html>
  <head>
    <title>updraft demo</title>
    <link rel="stylesheet" href="./assets/normalize.css" />
    <link rel="stylesheet" href="./assets/main.css" />
    <style>
      /* begin demo embedded styles */

      /* end demo embedded styles */
    </style>
  </head>
  <body>
    <h1>updraft demo</h1>

    <!-- begin demo markup -->

    <!-- end demo markup -->

    <p>See the <a href="http://arolson101.github.io/updraft">project homepage</a>.
    <p>Check out the <a href="https://github.com/arolson101/updraft">project repo</a>.
    <p>Copyright 2014 Andrew Olson</p>

    <script src="./../dist/updraft.js"></script>

    <script>
      /* begin demo script */
      
      var store = new Updraft.Store();

      var Todo = store.createClass({
        tableName: 'todos',
        //temp: true,
        columns: {
          id: {type: 'int', key: true},
          text: {type: 'text', index: true},
          attachment: {type: 'blob'},
          detail: {type: 'ptr'},
          tags: {type: 'list'},
        }
      });
      
      var Detail = store.createClass({
        tableName: 'details',
        columns: {
          id: {type: 'int', key: true},
          detail: {type: 'text'},
        }
      });
      
      var Tag = store.createClass({
        tableName: 'tags',
        //temp: true,
        columns: {
          id: {type: 'int', key: true},
          text: {type: 'text'}
        }
      });

      Todo.columns.detail.ref = Detail;
      Todo.columns.tags.ref = Tag;

      var to = new Todo({id: 123, text: "some text"});
      to.text = "other text";
      
//      var detail = new Detail({detail: 'more information about todo'});
//      to.detail = detail; // equivelant to: detail.todo = to;
//      // saving 'to' also saves 'to.detail' because 'to.detail' is changed
      

      //store.relateManyToMany(Todo.columns.tags, Tag.columns.todos);
      
      store.open({name: 'my db'})
        .then(function(db) {
          console.log('db ready');
//          var t1 = new Todo({id: 1, text: "todo 1"});
//          var t2 = new Todo({id: 1, text: "todo 1"});
//          db.save(t1, t2)
//            .then(function() {
//              console.log("t1 and t2 are saved");
//              Todo.all().then(function(todos) {
//                console.log(todos);
//              });
//            })
//            ;
        })
        ;

      /* end demo script */
    </script>
  </body>
</html>
