{"version":3,"sources":["assign.ts","Text.ts","verify.ts","Column.ts","Mutate.ts","Table.ts","Store.ts","index.ts","Query.ts","SQLiteWrapper.ts","WebsqlWrapper.ts"],"names":["Updraft","Updraft.toObject","Updraft.reviver","Updraft.toText","Updraft.fromText","Updraft.makePrintable","Updraft.verify","Updraft.ColumnType","Updraft.Column","Updraft.Column.constructor","Updraft.Column.Key","Updraft.Column.Index","Updraft.Column.Default","Updraft.Column.deserialize","Updraft.Column.serialize","Updraft.Column.Int","Updraft.Column.Real","Updraft.Column.Bool","Updraft.Column.Text","Updraft.Column.String","Updraft.Column.Enum","Updraft.Column.Date","Updraft.Column.DateTime","Updraft.Column.JSON","Updraft.Column.Set","Updraft.Column.sql","Updraft.Column.fromSql","Updraft.Column.equal","Updraft.shallowCopy","Updraft.shallowEqual","Updraft.keyOf","Updraft.verifyArrayCase","Updraft.verifySetCase","Updraft.mutate","Updraft.isMutated","Updraft.OrderBy","Updraft.Table","Updraft.Table.constructor","Updraft.Table.keyValue","Updraft.tableKey","Updraft.startsWith","Updraft.Store","Updraft.Store.constructor","Updraft.Store.createTable","Updraft.Store.open","Updraft.Store.readSchema","Updraft.Store.syncTable","Updraft.Store.loadKeyValues","Updraft.Store.getValue","Updraft.Store.setValue","Updraft.Store.add","Updraft.Store.find","Updraft.getChangeTableName","Updraft.getSetTableName","Updraft.buildIndices","Updraft.createInternalTableSpecs","Updraft.createChangeTableSpec","Updraft.createSetTableSpecs","Updraft.tableFromSql","Updraft.indexFromSql","Updraft.createTable","Updraft.dropTable","Updraft.createIndices","Updraft.copyData","Updraft.migrateChangeTable","Updraft.verifyGetValue","Updraft.insert","Updraft.insertElement","Updraft.insertElement.insertElementEachColumn","Updraft.resolve","Updraft.resolve.resolveSelectBaselineCallback","Updraft.resolve.resolveSelectBaselineCallback.resolveGetChangesCallback","Updraft.runQuery","Updraft.popValue","Updraft.selectBaseline","Updraft.loadExternals","Updraft.loadExternals.loadExternalsForEach","Updraft.loadExternals.loadExternalsForEach.loadExternalsSqlCallback","Updraft.getChanges","Updraft.applyChanges","Updraft.setLatest","Updraft.invalidateLatest","Updraft.selectableColumns","Updraft.serializeValue","Updraft.deserializeValue","Updraft.serializeChange","Updraft.deserializeChange","Updraft.deserializeRow","Updraft.createStore","Updraft.SQLiteWrapper","Updraft.SQLiteWrapper.constructor","Updraft.SQLiteWrapper.run","Updraft.SQLiteWrapper.all","Updraft.SQLiteWrapper.each","Updraft.SQLiteWrapper.transaction","Updraft.SQLiteWrapper.readTransaction","Updraft.createSQLiteWrapper","Updraft.WebsqlWrapper","Updraft.WebsqlWrapper.constructor","Updraft.WebsqlWrapper.trace","Updraft.WebsqlWrapper.stringify","Updraft.WebsqlWrapper.all","Updraft.WebsqlWrapper.each","Updraft.WebsqlWrapper.wrapTransaction","Updraft.WebsqlWrapper.transaction","Updraft.WebsqlWrapper.readTransaction","Updraft.createWebsqlWrapper"],"mappings":"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EAAEA,MAAMA,CAACA,CAACA,CAACA,CAACA,CAACA;gBACjIA,IAAIA,UAAUA,GAAGA,eAAeA,CAACA;gBACjCA,IAAIA,YAAYA,GAAGA,cAAcA,CAACA;gBAClCA,IAAIA,KAAKA,GAAGA,MAAMA,CAACA,CAACA,CAACA,CAACA,KAAKA,CAACA,UAAUA,CAACA,CAACA;gBACxCA,0BAA0BA;gBAC1BA,EAAEA,CAACA,CAACA,CAACA,KAAKA,CAACA,CAACA,CAACA;oBACZA,KAAKA,GAAGA,MAAMA,CAACA,CAACA,CAACA,CAACA,KAAKA,CAACA,YAAYA,CAACA,CAACA;gBACvCA,CAACA;gBACDA,EAAEA,CAACA,CAACA,KAAKA,CAACA,CAACA,CAACA;oBACXA,KAAKA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,GAAGA,cAAMA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;gBACpDA,CAACA;YACFA,CAACA;YAEDA,0BAA0BA;YAC1BA,EAAEA,CAACA,CAACA,OAAOA,CAACA,MAAMA,GAAGA,CAACA,CAACA,CAACA,CAACA;gBACxBA,IAAIA,EAAEA,GAAGA,OAAOA,CAACA,CAACA,CAACA,CAACA,KAAKA,CAACA,UAAUA,CAACA,CAACA;gBACtCA,0BAA0BA;gBAC1BA,EAAEA,CAACA,CAACA,EAAEA,CAACA,CAACA,CAACA;oBACRA,IAAIA,IAAIA,GAAGA,EAAEA,CAACA,CAACA,CAACA,CAACA,KAAKA,CAACA,GAAGA,CAACA,CAACA;oBAC5BA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,IAAIA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;wBACtCA,IAAIA,GAAGA,GAAGA,IAAIA,CAACA,CAACA,CAACA,CAACA,IAAIA,EAAEA,CAACA;wBACzBA,KAAKA,CAACA,OAAOA,CAACA,GAAGA,CAACA,CAACA,KAAKA,GAAGA,IAAIA,CAACA;oBACjCA,CAACA;gBACFA,CAACA;YACFA,CA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","file":"dist/updraft.js","sourcesContent":["\"use strict\";\r\n\r\nnamespace Updraft {\r\n\t/* istanbul ignore next */\r\n\tfunction toObject(val: any) {\r\n\t\tif (val === null || val === undefined) {\r\n\t\t\tthrow new TypeError(\"Object.assign cannot be called with null or undefined\");\r\n\t\t}\r\n\t\treturn Object(val);\r\n\t}\r\n\t\r\n\t/* istanbul ignore next */\r\n\tlet ObjectAssign = (<any>Object).assign || function (target: Object, source: Object) {\r\n\t\tconst hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\t\tconst propIsEnumerable = Object.prototype.propertyIsEnumerable;\r\n\t\tlet from: Object;\r\n\t\tlet to = toObject(target);\r\n\t\tlet symbols: any[];\r\n\t\r\n\t\tfor (let s = 1; s < arguments.length; s++) {\r\n\t\t\tfrom = Object(arguments[s]);\r\n\t\r\n\t\t\tfor (let key in from) {\r\n\t\t\t\tif (hasOwnProperty.call(from, key)) {\r\n\t\t\t\t\tto[key] = from[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif ((<any>Object).getOwnPropertySymbols) {\r\n\t\t\t\tsymbols = (<any>Object).getOwnPropertySymbols(from);\r\n\t\t\t\tfor (let i = 0; i < symbols.length; i++) {\r\n\t\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\r\n\t\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\treturn to;\r\n\t};\r\n\t\r\n\texport var assign = ObjectAssign;\r\n}\r\n","\"use strict\";\r\n\r\nnamespace Updraft {\r\n  function reviver(key: string, value: any): any {\r\n    if (typeof value === \"string\") {\r\n      let regexp = /^\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d.\\d\\d\\dZ$/.exec(value);\r\n      if (regexp) {\r\n        return new Date(value);\r\n      }\r\n    }\r\n    return value;\r\n  }\r\n  \r\n  export function toText(o: any): string {\r\n    return JSON.stringify(o);\r\n  }\r\n  \r\n  export function fromText(text: string): any {\r\n    return JSON.parse(text, reviver);\r\n  }\r\n}\r\n","\"use strict\";\r\n\r\nnamespace Updraft {\r\n  /* istanbul ignore next */\r\n  function makePrintable(x: any): string {\r\n    if (Array.isArray(x) || (x && typeof x === \"object\")) {\r\n      return JSON.stringify(x);\r\n    }\r\n    else {\r\n      return x;\r\n    }\r\n  }\r\n  \r\n  /**\r\n  * Use verify() to assert state which your program assumes to be true.\r\n  *\r\n  * Provide sprintf-style format (only %s is supported) and arguments\r\n  * to provide information about what broke and what you were\r\n  * expecting.\r\n  */\r\n  export function verify(condition: any, format: string, ...args: any[]) {\r\n    /* istanbul ignore next */\r\n    if (!condition) {\r\n      let argIndex = 0;\r\n      let error = new Error(\r\n        format.replace(/%s/g, function() { return makePrintable(args[argIndex++]); })\r\n      );\r\n  \r\n      (<any>error).framesToPop = 1; // we don't care about verify's own frame\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","///<reference path=\"./Text\"/>\r\n///<reference path=\"./verify\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n\r\n\texport enum ColumnType {\r\n\t\tint,\r\n\t\treal,\r\n\t\tbool,\r\n\t\ttext,\r\n\t\tenum,\r\n\t\tdate,\r\n\t\tdatetime,\r\n\t\tjson,\r\n\t\tset\r\n\t}\r\n\t\r\n\t/** A typescript enum class will have string keys resolving to the enum values */\r\n\texport interface TypeScriptEnum {\r\n\t\t[enumValue: number]: string;\r\n\t}\r\n\t\r\n\texport interface EnumValue {\r\n\t\ttoString(): string;\r\n\t}\r\n\t\r\n\t/** An enum class (e.g. (this one)[https://github.com/adrai/enum]) should provide a static method 'get' to resolve strings into enum values */\r\n\texport interface EnumClass {\r\n\t\tget(value: string | number): EnumValue;\r\n\t}\r\n\t\r\n\texport type Serializable = string | number;\r\n\t\r\n\t/**\r\n\t* Column in db.  Use static methods to create columns.\r\n\t*/\r\n\texport class Column {\r\n\t\tpublic isKey: boolean;\r\n\t\tpublic isIndex: boolean;\r\n\t\tpublic type: ColumnType;\r\n\t\t//public setTable: ClassTemplate<any>;\r\n\t\tpublic defaultValue: number | boolean | string;\r\n\t\tpublic enum: EnumClass | TypeScriptEnum;\r\n\t\tpublic element: Column;\r\n\t\r\n\t\tconstructor(type: ColumnType) {\r\n\t\t\tthis.type = type;\r\n\t\t\tif (type == ColumnType.bool) {\r\n\t\t\t\tthis.defaultValue = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t\t* Column is the primary key.  Only one column can have this set.\r\n\t\t\t*/\r\n\t\tKey(): Column {\r\n\t\t\tthis.isKey = true;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t\t* Create an index for this column for faster queries.\r\n\t\t\t*/\r\n\t\tIndex(): Column {\r\n\t\t\tthis.isIndex = true;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t\t* Set a default value for the column\r\n\t\t\t*/\r\n\t\t// TODO\r\n\t\tDefault(value: number | boolean | string): Column {\r\n\t\t\tif (this.type == ColumnType.bool) {\r\n\t\t\t\tvalue = value ? true : false;\r\n\t\t\t}\r\n\t\t\tthis.defaultValue = value;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tdeserialize(value: Serializable): any {\r\n\t\t\tswitch (this.type) {\r\n\t\t\t\tcase ColumnType.int:\r\n\t\t\t\tcase ColumnType.real:\r\n\t\t\t\tcase ColumnType.text:\r\n\t\t\t\t\treturn value;\r\n\t\r\n\t\t\t\tcase ColumnType.bool:\r\n\t\t\t\t\treturn value ? true : false;\r\n\t\r\n\t\t\t\tcase ColumnType.json:\r\n\t\t\t\t\treturn fromText(<string>value);\r\n\t\r\n\t\t\t\tcase ColumnType.enum:\r\n\t\t\t\t\tif (typeof (<EnumClass>this.enum).get === \"function\") {\r\n\t\t\t\t\t\tlet enumValue = (<EnumClass>this.enum).get(value);\r\n\t\t\t\t\t\tverify(!value || enumValue, \"error getting enum value %s\", value);\r\n\t\t\t\t\t\treturn enumValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tverify(value in this.enum, \"enum value %s not in %s\", value, this.enum);\r\n\t\t\t\t\treturn this.enum[value];\r\n\t\r\n\t\t\t\tcase ColumnType.date:\r\n\t\t\t\tcase ColumnType.datetime:\r\n\t\t\t\t\tverify(!value || parseFloat(<string>value) == value, \"expected date to be stored as a number: %s\", value);\r\n\t\t\t\t\treturn value ? new Date(parseFloat(<string>value) * 1000) : undefined;\r\n\t\t\t\t\t\r\n\t\t\t\tcase ColumnType.set:\r\n\t\t\t\t\tverify(<any>value instanceof Set, \"value should already be a set\");\r\n\t\t\t\t\treturn value;\r\n\t\r\n\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"unsupported column type \" + ColumnType[this.type]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tserialize(value: any): Serializable {\r\n\t\t\tswitch (this.type) {\r\n\t\t\t\tcase ColumnType.int:\r\n\t\t\t\tcase ColumnType.real:\r\n\t\t\t\tcase ColumnType.text:\r\n\t\t\t\t\treturn value;\r\n\t\r\n\t\t\t\tcase ColumnType.bool:\r\n\t\t\t\t\treturn value ? 1 : 0;\r\n\t\r\n\t\t\t\tcase ColumnType.json:\r\n\t\t\t\t\treturn toText(value);\r\n\t\r\n\t\t\t\tcase ColumnType.enum:\r\n\t\t\t\t\t/* istanbul ignore if: safe to store these in db, though it's probably an error to be anything other than a number/object */\r\n\t\t\t\t\tif (typeof value === \"string\" || typeof value === undefined || value === null) {\r\n\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof value === \"number\") {\r\n\t\t\t\t\t\tverify(value in this.enum, \"enum doesn't contain %s\", value);\r\n\t\t\t\t\t\treturn (<TypeScriptEnum>this.enum)[value];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tverify(typeof value.toString === \"function\", \"expected an enum value supporting toString(); got %s\", value);\r\n\t\t\t\t\treturn value.toString();\r\n\t\r\n\t\t\t\tcase ColumnType.date:\r\n\t\t\t\tcase ColumnType.datetime:\r\n\t\t\t\t\tverify(value == undefined || value instanceof Date, \"expected a date, got %s\", value);\r\n\t\t\t\t\tlet date = (value == undefined) ? null : ((<Date>value).getTime() / 1000);\r\n\t\t\t\t\treturn date;\r\n\t\r\n\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"unsupported column type \" + ColumnType[this.type]);\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t/** create a column with \"INTEGER\" affinity */\r\n\t\tstatic Int(): Column {\r\n\t\t\treturn new Column(ColumnType.int);\r\n\t\t}\r\n\t\r\n\t\t/** create a column with \"REAL\" affinity */\r\n\t\tstatic Real(): Column {\r\n\t\t\treturn new Column(ColumnType.real);\r\n\t\t}\r\n\t\r\n\t\t/** create a column with \"BOOL\" affinity */\r\n\t\tstatic Bool(): Column {\r\n\t\t\treturn new Column(ColumnType.bool);\r\n\t\t}\r\n\t\r\n\t\t/** create a column with \"TEXT\" affinity */\r\n\t\tstatic Text(): Column {\r\n\t\t\treturn new Column(ColumnType.text);\r\n\t\t}\r\n\t\r\n\t\t/** create a column with \"TEXT\" affinity */\r\n\t\tstatic String(): Column {\r\n\t\t\treturn new Column(ColumnType.text);\r\n\t\t}\r\n\t\r\n\t\t/** a typescript enum or javascript object with instance method \"toString\" and class method \"get\" (e.g. {@link https://github.com/adrai/enum}). */\r\n\t\tstatic Enum(enum_: EnumClass | TypeScriptEnum): Column {\r\n\t\t\tlet c = new Column(ColumnType.enum);\r\n\t\t\tc.enum = enum_;\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\r\n\t\t/** a javascript Date objct, stored in db as seconds since Unix epoch (time_t) [note: precision is seconds] */\r\n\t\tstatic Date(): Column {\r\n\t\t\treturn new Column(ColumnType.date);\r\n\t\t}\r\n\t\r\n\t\t/** a javascript Date objct, stored in db as seconds since Unix epoch (time_t) [note: precision is seconds] */\r\n\t\tstatic DateTime(): Column {\r\n\t\t\treturn new Column(ColumnType.datetime);\r\n\t\t}\r\n\t\r\n\t\t/** object will be serialized & restored as JSON text */\r\n\t\tstatic JSON(): Column {\r\n\t\t\treturn new Column(ColumnType.json);\r\n\t\t}\r\n\t\r\n\t\t/** unordered collection */\r\n\t\tstatic Set(type: ColumnType): Column {\r\n\t\t\tlet c = new Column(ColumnType.set);\r\n\t\t\tc.element = new Column(type);\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\r\n\t\r\n\t\tstatic sql(val: Column): string {\r\n\t\t\tlet stmt = \"\";\r\n\t\t\tswitch (val.type) {\r\n\t\t\t\tcase ColumnType.int:\r\n\t\t\t\t\tstmt = \"INTEGER\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.bool:\r\n\t\t\t\t\tstmt = \"BOOLEAN NOT NULL\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.real:\r\n\t\t\t\t\tstmt = \"REAL\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.text:\r\n\t\t\t\t\tstmt = \"TEXT\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.json:\r\n\t\t\t\t\tstmt = \"CLOB\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.enum:\r\n\t\t\t\t\tstmt = \"CHARACTER(20)\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.date:\r\n\t\t\t\t\tstmt = \"DATE\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ColumnType.datetime:\r\n\t\t\t\t\tstmt = \"DATETIME\";\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"unsupported type \" + ColumnType[val.type]);\r\n\t\t\t}\r\n\t\r\n\t\t\tif (\"defaultValue\" in val) {\r\n\t\t\t\tlet escape = function(x: string | number | boolean): string {\r\n\t\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\t\tif (typeof x === \"number\") {\r\n\t\t\t\t\t\treturn <any>x;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof x === \"string\") {\r\n\t\t\t\t\t\treturn \"'\" + (<string>x).replace(/'/g, \"''\") + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tverify(false, \"default value (%s) must be number or string\", x);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tstmt += \" DEFAULT \" + escape(val.serialize(val.defaultValue));\r\n\t\t\t}\r\n\t\r\n\t\t\treturn stmt;\r\n\t\t}\r\n\t\r\n\t\tstatic fromSql(text: string): Column {\r\n\t\t\tlet parts: string[] = text.split(\" \");\r\n\t\t\tlet col: Column = null;\r\n\t\t\tswitch (parts[0]) {\r\n\t\t\t\tcase \"INTEGER\":\r\n\t\t\t\t\tcol = Column.Int();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"BOOLEAN\":\r\n\t\t\t\t\tcol = Column.Bool();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"REAL\":\r\n\t\t\t\t\tcol = Column.Real();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"TEXT\":\r\n\t\t\t\t\tcol = Column.Text();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"CLOB\":\r\n\t\t\t\t\tcol = Column.JSON();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"CHARACTER(20)\":\r\n\t\t\t\t\tcol = new Column(ColumnType.enum);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"DATE\":\r\n\t\t\t\t\tcol = Column.Date();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"DATETIME\":\r\n\t\t\t\t\tcol = Column.DateTime();\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"unsupported type: \" + ColumnType[parts[0]]);\r\n\t\t\t}\r\n\t\r\n\t\t\tlet match = text.match(/DEFAULT\\s+'((?:[^']|'')*)'/i);\r\n\t\t\tif (match) {\r\n\t\t\t\tlet val: any = match[1].replace(/''/g, \"'\");\r\n\t\t\t\tcol.Default(val);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tmatch = text.match(/DEFAULT\\s+(\\S+)/i);\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\tlet val: any = match[1];\r\n\t\t\t\t\tlet valnum = parseFloat(val);\r\n\t\t\t\t\t/* istanbul ignore else: unlikely to be anything but a number */\r\n\t\t\t\t\tif (val == valnum) {\r\n\t\t\t\t\t\tval = valnum;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcol.Default(val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\treturn col;\r\n\t\t}\r\n\t\r\n\t\tstatic equal(a: Column, b: Column): boolean {\r\n\t\t\tif (a.type != b.type) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif ((a.defaultValue || b.defaultValue) && (a.defaultValue != b.defaultValue)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t/* istanbul ignore next: I don't think this is possible */\r\n\t\t\tif ((a.isKey || b.isKey) && (a.isKey != b.isKey)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\t\r\n\texport interface ColumnSet {\r\n\t\t[name: string]: Column;\r\n\t}\r\n}\r\n","// written to React\"s immutability helpers spec\r\n// see https://facebook.github.io/react/docs/update.html\r\n\r\n///<reference path=\"../typings/tsd.d.ts\"/>\r\n///<reference path=\"./assign\"/>\r\n///<reference path=\"./verify\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n  export namespace Mutate {\r\n    export interface setter<T> {\r\n      $set: T;\r\n    }\r\n    \r\n    export interface increment {\r\n      $inc: number;\r\n    }\r\n    \r\n    export interface push<T> {\r\n      $push: Array<T>;\r\n    }\r\n    \r\n    export interface unshift<T> {\r\n      $unshift: Array<T>;\r\n    }\r\n    \r\n    export interface splice<T> {\r\n      // array.splice(start, deleteCount[, item1[, item2[, ...]]])\r\n      $splice: Array<Array<number | T>>;\r\n    }\r\n    \r\n    export interface merge<T> {\r\n      $merge: T;\r\n    }\r\n    \r\n    export interface add<T> {\r\n      $add: Array<T>;\r\n    }\r\n    \r\n    export interface deleter<T> {\r\n      $delete: Array<T>;\r\n    }\r\n    \r\n    export type primitive<T> =\r\n      setter<T>;\r\n    \r\n    export type none = void;\r\n    export type bool = primitive<boolean>;\r\n    export type num = primitive<number> | increment;\r\n    export type str = primitive<string>;\r\n    export type date = setter<Date>;\r\n    export type obj = primitive<Object> | merge<Object> | deleter<string>;\r\n    export type enm<T> = primitive<T>;\r\n    \r\n    export type array<T> =\r\n      setter<Array<T>> |\r\n      push<T> |\r\n      unshift<T> |\r\n      splice<T> |\r\n      merge<T>;\r\n    \r\n    export type strArray = array<string>;\r\n    export type numArray = array<number>;\r\n    export type objArray = array<Object>;\r\n    \r\n    export type set<T> =\r\n      setter<Set<T>> |\r\n      add<T> |\r\n      deleter<T>;\r\n    \r\n    export type strSet = set<string>;\r\n  }\r\n  \r\n  export function shallowCopy<T>(x: T): T {\r\n    /* istanbul ignore else: not sure about this one */\r\n    if (Array.isArray(x)) {\r\n      return (<any>x).concat();\r\n    }\r\n    else if (x instanceof Set) {\r\n      return <any>new Set<T>(<any>x);\r\n    }\r\n    else if (typeof x === \"object\") {\r\n      return assign(new (<any>x).constructor(), x);\r\n    }\r\n    else {\r\n      /* istanbul ignore next: correct AFAIK but unreachable */\r\n      return x;\r\n    }\r\n  }\r\n  \r\n  export function shallowEqual<T>(a: T, b: T): boolean {\r\n    if (Array.isArray(a) && Array.isArray(b)) {\r\n      let aa: any[] = <any>a;\r\n      let bb: any[] = <any>b;\r\n      if (aa.length == bb.length) {\r\n        for (let i = 0; i < aa.length; i++) {\r\n          if (aa[i] != bb[i]) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n    else if (a instanceof Set && b instanceof Set) {\r\n      let aa: Set<any> = <any>a;\r\n      let bb: Set<any> = <any>b;\r\n      if (aa.size == bb.size) {\r\n        let equal = true;\r\n        aa.forEach((elt) => {\r\n          if (equal && !bb.has(elt)) {\r\n            equal = false;\r\n          }\r\n        });\r\n        return equal;\r\n      }\r\n      return false;\r\n    }\r\n    else if (a instanceof Date && b instanceof Date) {\r\n      return (<Date><any>a).getTime() == (<Date><any>b).getTime();\r\n    }\r\n    else if (a && typeof a == \"object\" && b && typeof b == \"object\") {\r\n      let akeys = Object.keys(a);\r\n      let bkeys = Object.keys(b);\r\n      if (akeys.length == bkeys.length) {\r\n        for (let key of akeys) {\r\n          if (!(key in b) || a[key] != b[key]) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n    return a == b;\r\n  }\r\n  \r\n  \r\n  export let hasOwnProperty = {}.hasOwnProperty;\r\n  export function keyOf(obj: Object) { return Object.keys(obj)[0]; }\r\n  \r\n  let command = {\r\n    set: keyOf({$set: null}),\r\n    increment: keyOf({$inc: null}),\r\n    push: keyOf({$push: null}),\r\n    unshift: keyOf({$unshift: null}),\r\n    splice: keyOf({$splice: null}),\r\n    merge: keyOf({$merge: null}),\r\n    add: keyOf({$add: null}),\r\n    deleter: keyOf({$delete: null}),\r\n  };\r\n  \r\n  \r\n  function verifyArrayCase(value: any, spec: any, c: string) {\r\n    verify(\r\n      Array.isArray(value),\r\n      \"mutate(): expected target of %s to be an array; got %s.\",\r\n      c,\r\n      value\r\n    );\r\n    let specValue = spec[c];\r\n    verify(\r\n      Array.isArray(specValue),\r\n      \"mutate(): expected spec of %s to be an array; got %s. \" +\r\n      \"Did you forget to wrap your parameter in an array?\",\r\n      c,\r\n      specValue\r\n    );\r\n  }\r\n  \r\n  function verifySetCase(value: any, spec: any, c: string) {\r\n    verify(\r\n      value instanceof Set,\r\n      \"mutate(): expected target of %s to be a set; got %s.\",\r\n      c,\r\n      value\r\n    );\r\n    let specValue = spec[c];\r\n    verify(\r\n      Array.isArray(specValue),\r\n      \"mutate(): expected spec of %s to be an array; got %s. \" +\r\n      \"Did you forget to wrap your parameter in an array?\",\r\n      c,\r\n      specValue\r\n    );\r\n  }\r\n  \r\n  export function mutate<Element, Mutator>(value: Element, spec: Mutator): Element {\r\n    verify(\r\n      typeof spec === \"object\",\r\n      \"mutate(): You provided a key path to mutate() that did not contain one \" +\r\n      \"of %s. Did you forget to include {%s: ...}?\",\r\n      Object.keys(command).join(\", \"),\r\n      command.set\r\n    );\r\n  \r\n    // verify(\r\n    // \tObject.keys(spec).reduce( function(previousValue: boolean, currentValue: string): boolean {\r\n    // \t\treturn previousValue && (keyOf(spec[currentValue]) in command);\r\n    // \t}, true),\r\n    // \t\"mutate(): argument has an unknown key; supported keys are (%s).  mutator: %s\",\r\n    // \tObject.keys(command).join(\", \"),\r\n    // \tspec\r\n    // );\r\n  \r\n    if (hasOwnProperty.call(spec, command.set)) {\r\n      verify(\r\n        Object.keys(spec).length === 1,\r\n        \"Cannot have more than one key in an object with %s\",\r\n        command.set\r\n      );\r\n  \r\n      return shallowEqual(value, spec[command.set]) ? value : spec[command.set];\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.increment)) {\r\n      verify(\r\n        typeof(value) === \"number\" && typeof(spec[command.increment]) === \"number\",\r\n        \"Source (%s) and argument (%s) to %s must be numbers\",\r\n        value,\r\n        spec[command.increment],\r\n        command.increment\r\n      );\r\n  \r\n      return value + spec[command.increment];\r\n    }\r\n  \r\n    let changed = false;\r\n  \r\n    if (hasOwnProperty.call(spec, command.merge)) {\r\n      let mergeObj = spec[command.merge];\r\n      let nextValue = <any>shallowCopy(value);\r\n      verify(\r\n        mergeObj && typeof mergeObj === \"object\",\r\n        \"mutate(): %s expects a spec of type 'object'; got %s\",\r\n        command.merge,\r\n        mergeObj\r\n      );\r\n      verify(\r\n        nextValue && typeof nextValue === \"object\",\r\n        \"mutate(): %s expects a target of type 'object'; got %s\",\r\n        command.merge,\r\n        nextValue\r\n      );\r\n      assign(nextValue, spec[command.merge]);\r\n      return shallowEqual(value, nextValue) ? value : nextValue;\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.deleter) && (typeof value === \"object\") && !(value instanceof Set)) {\r\n      let keys = <any[]>spec[command.deleter];\r\n      verify(\r\n        keys && Array.isArray(keys),\r\n        \"mutate(): %s expects a spec of type 'array'; got %s\",\r\n        command.deleter,\r\n        keys\r\n      );\r\n      let nextValue = <any>shallowCopy(value);\r\n      changed = false;\r\n      keys.forEach((key: string) => {\r\n        if (key in value) {\r\n          delete nextValue[key];\r\n          changed = true;\r\n        }\r\n      });\r\n      return changed ? <any>nextValue : value;\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.push)) {\r\n      let nextValue: any[] = <any>shallowCopy(value) || [];\r\n      verifyArrayCase(nextValue, spec, command.push);\r\n      if (spec[command.push].length) {\r\n        nextValue.push.apply(nextValue, spec[command.push]);\r\n        return <any>nextValue;\r\n      }\r\n      else {\r\n        return value;\r\n      }\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.unshift)) {\r\n      verifyArrayCase(value, spec, command.unshift);\r\n      if (spec[command.unshift].length) {\r\n        let nextValue: any[] = <any>shallowCopy(value);\r\n        nextValue.unshift.apply(nextValue, spec[command.unshift]);\r\n        return <any>nextValue;\r\n      }\r\n      else {\r\n        return value;\r\n      }\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.splice)) {\r\n      let nextValue: any = <any>shallowCopy(value);\r\n      verify(\r\n        Array.isArray(value),\r\n        \"Expected %s target to be an array; got %s\",\r\n        command.splice,\r\n        value\r\n      );\r\n      verify(\r\n        Array.isArray(spec[command.splice]),\r\n        \"mutate(): expected spec of %s to be an array of arrays; got %s. \" +\r\n        \"Did you forget to wrap your parameters in an array?\",\r\n        command.splice,\r\n        spec[command.splice]\r\n      );\r\n      spec[command.splice].forEach(function(args: any) {\r\n        verify(\r\n          Array.isArray(args),\r\n          \"mutate(): expected spec of %s to be an array of arrays; got %s. \" +\r\n          \"Did you forget to wrap your parameters in an array?\",\r\n          command.splice,\r\n          spec[command.splice]\r\n        );\r\n        (<any>nextValue).splice.apply(nextValue, args);\r\n      });\r\n      return shallowEqual(nextValue, value) ? value : nextValue;\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.add)) {\r\n      let nextValue: Set<any> = <any>shallowCopy(value) || new Set<any>();\r\n      verifySetCase(nextValue, spec, command.add);\r\n      spec[command.add].forEach(function(item: any) {\r\n        if (!nextValue.has(item)) {\r\n          nextValue.add(item);\r\n          changed = true;\r\n        }\r\n      });\r\n      return changed ? <any>nextValue : value;\r\n    }\r\n  \r\n    if (hasOwnProperty.call(spec, command.deleter) && (value instanceof Set)) {\r\n      let nextValue: Set<any> = <any>shallowCopy(value);\r\n      verifySetCase(value, spec, command.deleter);\r\n      spec[command.deleter].forEach(function(item: any) {\r\n        if (nextValue.delete(item)) {\r\n          changed = true;\r\n        }\r\n      });\r\n      return changed ? <any>nextValue : value;\r\n    }\r\n  \r\n    let nextValue: any;\r\n    for (let k in spec) {\r\n      if (typeof value === \"object\" && !(command.hasOwnProperty(k))) {\r\n        let oldValue = value[k];\r\n        let newValue = mutate(oldValue, spec[k]);\r\n        if (oldValue !== newValue) {\r\n          if (!nextValue) {\r\n            nextValue = <any>shallowCopy(value);\r\n          }\r\n          nextValue[k] = newValue;\r\n          changed = true;\r\n        }\r\n      }\r\n    }\r\n  \r\n    return changed ? nextValue : value;\r\n  }\r\n  \r\n  \r\n  export function isMutated<Element>(a: Element, b: Element): boolean {\r\n    return a !== b;\r\n  }\r\n}\r\n","///<reference path=\"./Column\"/>\r\n///<reference path=\"./verify\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n\texport type KeyType = string | number;\r\n\t\r\n\texport interface TableChange<Element, Mutator> {\r\n\t\ttime?: number;\r\n\t\tdelete?: KeyType;\r\n\t\tchange?: Mutator;\r\n\t\tsave?: Element;\r\n\t}\r\n\t\r\n\texport interface TableSpec<Element, Mutator, Query> {\r\n\t\tname: string;\r\n\t\tcolumns: ColumnSet;\r\n\t\trenamedColumns?: RenamedColumnSet;\r\n\t\tindices?: string[][];\r\n\t\tclazz?: new (props: Element) => Element; \r\n\t}\r\n\t\r\n\texport interface RenamedColumnSet {\r\n\t\t\t[oldColumnName: string]: string;\r\n\t}\r\n\t\r\n\texport enum OrderBy {\r\n\t\tASC,\r\n\t\tDESC\r\n\t}\r\n\t\r\n\texport interface OrderBySpec {\r\n\t\t[name: string]: OrderBy;\r\n\t}\r\n\t\r\n\texport interface FieldSpec {\r\n\t\t[fieldName: string]: boolean;\r\n\t}\r\n\t\r\n\texport interface FindOpts {\r\n\t\tfields?: FieldSpec;\r\n\t\torderBy?: OrderBySpec;\r\n\t\toffset?: number;\r\n\t\tlimit?: number;\r\n\t\tcount?: boolean;\r\n\t}\r\n\t\r\n\texport class Table<Element, Mutator, Query> {\r\n\t\tspec: TableSpec<Element, Mutator, Query>;\r\n\t\tkey: KeyType;\r\n\t\r\n\t\tconstructor(spec: TableSpec<Element, Mutator, Query>) {\r\n\t\t\tthis.spec = spec;\r\n\t\t\tthis.key = tableKey(spec);\r\n\t\t}\r\n\t\r\n\t\tkeyValue(element: Element | Mutator): KeyType {\r\n\t\t\tverify(this.key in element, \"object does not have key field '%s' set: %s\", this.key, element);\r\n\t\t\treturn element[this.key];\r\n\t\t}\r\n\t\r\n\t\tfind: (query: Query, opts?: FindOpts) => Promise<Element[]>;\r\n\t\tadd: (...changes: TableChange<Element, Mutator>[]) => Promise<any>;\r\n\t}\r\n\t\r\n\t\r\n\texport function tableKey(spec: TableSpec<any, any, any>): KeyType {\r\n\t\tlet key: KeyType = null;\r\n\t\tfor (let name in spec.columns) {\r\n\t\t\tlet column = spec.columns[name];\r\n\t\t\tverify(column, \"column '%s' is not in %s\", name, spec);\r\n\t\t\tif (column.isKey) {\r\n\t\t\t\tverify(!key, \"Table %s has more than one key- %s and %s\", spec.name, key, name);\r\n\t\t\t\tkey = name;\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tverify(key, \"Table %s does not have a key\", spec.name);\r\n\t\treturn key;\r\n\t}\r\n}\r\n","///<reference path=\"./Mutate\"/>\r\n///<reference path=\"./Column\"/>\r\n///<reference path=\"./Database\"/>\r\n///<reference path=\"./Table\"/>\r\n///<reference path=\"./Text\"/>\r\n///<reference path=\"./assign\"/>\r\n///<reference path=\"./verify\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n\r\n\tfunction startsWith(str: string, val: string) {\r\n\t\treturn str.lastIndexOf(val, 0) === 0;\r\n\t}\r\n\t\r\n\texport type TableSpecAny = TableSpec<any, any, any>;\r\n\texport type TableAny = Table<any, any, any>;\r\n\t\r\n\texport interface CreateStoreParams {\r\n\t\tdb: DbWrapper;\r\n\t}\r\n\t\r\n\texport interface Schema {\r\n\t\t[table: string]: TableSpecAny;\r\n\t}\r\n\t\r\n\tinterface SqliteMasterRow {\r\n\t\ttype: string;\r\n\t\tname: string;\r\n\t\ttbl_name: string;\r\n\t\tsql: string;\r\n\t}\r\n\t\r\n\tinterface BaselineInfo<Element> {\r\n\t\telement: Element;\r\n\t\ttime: number;\r\n\t\trowid: number;\r\n\t}\r\n\t\r\n\tinterface ChangeTableRow {\r\n\t\tkey?: KeyType;\r\n\t\ttime?: number;\r\n\t\tchange?: string;\r\n\t}\r\n\t\r\n\tinterface SetTableRow {\r\n\t\tkey?: KeyType;\r\n\t\ttime?: number;\r\n\t\tvalue?: string;\r\n\t}\r\n\r\n\tinterface KeyValue {\r\n\t\tkey?: string;\r\n\t\tvalue?: any; // stored as JSON\r\n\t}\r\n\t\r\n\tinterface KeyValueMap {\r\n\t\t[key: string]: any;\r\n\t}\r\n\r\n\tconst ROWID = \"rowid\";\r\n\tconst COUNT = \"COUNT(*)\";\r\n\tconst internal_prefix = \"updraft_\";\r\n\tconst internal_column_deleted = internal_prefix + \"deleted\";\r\n\tconst internal_column_time = internal_prefix + \"time\";\r\n\tconst internal_column_latest = internal_prefix + \"latest\";\r\n\tconst internal_column_composed = internal_prefix + \"composed\";\r\n\tconst internalColumn: ColumnSet = {};\r\n\tinternalColumn[internal_column_deleted] = Column.Bool();\r\n\tinternalColumn[internal_column_time] = Column.Int().Key();\r\n\tinternalColumn[internal_column_latest] = Column.Bool();\r\n\tinternalColumn[internal_column_composed] = Column.Bool();\r\n\t\r\n\tconst deleteRow_action = { [internal_column_deleted]: { $set: true } };\r\n\t\r\n\tconst keyValueTableSpec: TableSpec<KeyValue, any, any> = {\r\n\t\tname: internal_prefix + \"keyValues\",\r\n\t\tcolumns: {\r\n\t\t\tkey: Column.String().Key(),\r\n\t\t\tvalue: Column.JSON(),\r\n\t\t}\r\n\t};\r\n\t\r\n\texport class Store {\r\n\t\tprivate params: CreateStoreParams;\r\n\t\tprivate tables: TableSpecAny[];\r\n\t\tprivate db: DbWrapper;\r\n\t\tprivate keyValueTable: Table<KeyValue, any, any>;\r\n\t\tprivate keyValues: KeyValueMap;\r\n\t\r\n\t\tconstructor(params: CreateStoreParams) {\r\n\t\t\tthis.params = params;\r\n\t\t\tthis.tables = [];\r\n\t\t\tthis.db = null;\r\n\t\t\tverify(this.params.db, \"must pass a DbWrapper\");\r\n\t\t\tthis.keyValueTable = this.createTable<KeyValue, any, any>(keyValueTableSpec);\r\n\t\t}\r\n\t\r\n\t\tcreateTable<Element, Mutator, Query>(tableSpec: TableSpec<Element, Mutator, Query>): Table<Element, Mutator, Query> {\r\n\t\t\tverify(!this.db, \"createTable() can only be added before open()\");\r\n\t\t\tif (tableSpec !== keyValueTableSpec) {\r\n\t\t\t\tverify(!startsWith(tableSpec.name, internal_prefix), \"table name %s cannot begin with %s\", tableSpec.name, internal_prefix);\r\n\t\t\t}\r\n\t\t\tfor (let col in tableSpec.columns) {\r\n\t\t\t\tverify(!startsWith(col, internal_prefix), \"table %s column %s cannot begin with %s\", tableSpec.name, col, internal_prefix);\r\n\t\t\t}\r\n\t\t\tlet table = new Table<Element, Mutator, Query>(tableSpec);\r\n\t\t\ttable.add = (...changes: TableChange<Element, Mutator>[]): Promise<any> => this.add(table, ...changes);\r\n\t\t\ttable.find = (query: Query, opts?: FindOpts): Promise<Element[]> => this.find(table, query, opts);\r\n\t\t\tthis.tables.push(...createInternalTableSpecs(table));\r\n\t\t\tthis.tables.push(createChangeTableSpec(table));\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\r\n\t\topen(): Promise<any> {\r\n\t\t\tverify(!this.db, \"open() called more than once!\");\r\n\t\t\tverify(this.tables.length, \"open() called before any tables were added\");\r\n\t\r\n\t\t\tthis.db = this.params.db;\r\n\t\r\n\t\t\treturn Promise.resolve()\r\n\t\t\t\t.then(() => this.readSchema())\r\n\t\t\t\t.then((schema) => {\r\n\t\t\t\t\treturn this.db.transaction((transaction: DbTransaction) => {\r\n\t\t\t\t\t\tlet p = Promise.resolve();\r\n\t\t\t\t\t\tthis.tables.forEach(\r\n\t\t\t\t\t\t\t(table: TableSpecAny) => {\r\n\t\t\t\t\t\t\t\tp = p.then(() => this.syncTable(transaction, schema, table));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tp = p.then(() => this.loadKeyValues(transaction));\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t;\r\n\t\t}\r\n\t\r\n\t\treadSchema(): Promise<Schema> {\r\n\t\t\tverify(this.db, \"readSchema(): not opened\");\r\n\t\r\n\t\t\treturn this.db.readTransaction((transaction: DbTransaction) => {\r\n\t\t\t\treturn transaction.executeSql(\"SELECT name, tbl_name, type, sql FROM sqlite_master\", [], (tx: DbTransaction, resultSet: any[]) => {\r\n\t\t\t\t\tlet schema: Schema = {};\r\n\t\t\t\t\tfor (let i = 0; i < resultSet.length; i++) {\r\n\t\t\t\t\t\tlet row = <SqliteMasterRow>resultSet[i];\r\n\t\t\t\t\t\tif (row.name[0] != \"_\" && !startsWith(row.name, \"sqlite\")) {\r\n\t\t\t\t\t\t\tswitch (row.type) {\r\n\t\t\t\t\t\t\t\tcase \"table\":\r\n\t\t\t\t\t\t\t\t\tschema[row.name] = tableFromSql(row.name, row.sql);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase \"index\":\r\n\t\t\t\t\t\t\t\t\tlet index = indexFromSql(row.sql);\r\n\t\t\t\t\t\t\t\t\tif (index.length == 1) {\r\n\t\t\t\t\t\t\t\t\t\tlet col = index[0];\r\n\t\t\t\t\t\t\t\t\t\tverify(row.tbl_name in schema, \"table %s used by index %s should have been returned first\", row.tbl_name, row.name);\r\n\t\t\t\t\t\t\t\t\t\tverify(col in schema[row.tbl_name].columns, \"table %s does not have column %s used by index %s\", row.tbl_name, col, row.name);\r\n\t\t\t\t\t\t\t\t\t\tschema[row.tbl_name].columns[col].isIndex = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tschema[row.tbl_name].indices.push(index);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t// case \"trigger\":\r\n\t\t\t\t\t\t\t\t// \tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treturn schema;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tprivate syncTable(transaction: DbTransaction, schema: Schema, spec: TableSpecAny): Promise<any> {\r\n\t\t\tlet p = Promise.resolve();\r\n\t\t\tif (spec.name in schema) {\r\n\t\t\t\tlet oldColumns = schema[spec.name].columns;\r\n\t\t\t\tlet newColumns = spec.columns;\r\n\t\t\t\tlet recreateTable: boolean = false;\r\n\t\r\n\t\t\t\tfor (let colName in oldColumns) {\r\n\t\t\t\t\tif (!(colName in newColumns)) {\r\n\t\t\t\t\t\trecreateTable = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tlet oldCol = oldColumns[colName];\r\n\t\t\t\t\tlet newCol = newColumns[colName];\r\n\t\t\t\t\tif (!Column.equal(oldCol, newCol)) {\r\n\t\t\t\t\t\trecreateTable = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tlet renamedColumns = spec.renamedColumns || {};\r\n\t\t\t\tfor (let colName in renamedColumns) {\r\n\t\t\t\t\tif (colName in oldColumns) {\r\n\t\t\t\t\t\trecreateTable = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tlet addedColumns: ColumnSet = {};\r\n\t\t\t\tif (!recreateTable) {\r\n\t\t\t\t\tfor (let colName of selectableColumns(spec, newColumns)) {\r\n\t\t\t\t\t\tif (!(colName in oldColumns)) {\r\n\t\t\t\t\t\t\taddedColumns[colName] = newColumns[colName];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (recreateTable) {\r\n\t\t\t\t\t// recreate and migrate data\r\n\t\t\t\t\tlet renameTable = function(oldName: string, newName: string): Promise<any> {\r\n\t\t\t\t\t\treturn transaction.executeSql(\"ALTER TABLE \" + oldName + \" RENAME TO \" + newName);\r\n\t\t\t\t\t};\r\n\t\r\n\t\t\t\t\tlet tempTableName = \"temp_\" + spec.name;\r\n\t\t\t\t\tlet changeTableName = getChangeTableName(spec.name);\r\n\t\r\n\t\t\t\t\t/* istanbul ignore if: yikes!  migration failed but transaction got committed? */\r\n\t\t\t\t\tif (tempTableName in schema) {\r\n\t\t\t\t\t\tp = p.then(() => dropTable(transaction, tempTableName));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tp = p.then(() => createTable(transaction, tempTableName, spec.columns));\r\n\t\t\t\t\tp = p.then(() => copyData(transaction, spec.name, tempTableName, oldColumns, newColumns, renamedColumns));\r\n\t\t\t\t\tp = p.then(() => dropTable(transaction, spec.name));\r\n\t\t\t\t\tp = p.then(() => renameTable(tempTableName, spec.name));\r\n\t\t\t\t\tp = p.then(() => migrateChangeTable(transaction, changeTableName, oldColumns, newColumns, renamedColumns));\r\n\t\t\t\t\tp = p.then(() => createIndices(transaction, schema, spec, true));\r\n\t\t\t\t}\r\n\t\t\t\telse if (Object.keys(addedColumns).length > 0) {\r\n\t\t\t\t\t// alter table, add columns\r\n\t\t\t\t\tObject.keys(addedColumns).forEach((colName) => {\r\n\t\t\t\t\t\tlet col: Column = spec.columns[colName];\r\n\t\t\t\t\t\tlet columnDecl = colName + \" \" + Column.sql(col);\r\n\t\t\t\t\t\tp = p.then(() => transaction.executeSql(\"ALTER TABLE \" + spec.name + \" ADD COLUMN \" + columnDecl));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tp = p.then(() => createIndices(transaction, schema, spec));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// no table modification is required\r\n\t\t\t\t\tp = p.then(() => createIndices(transaction, schema, spec));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// create new table\r\n\t\t\t\tp = p.then(() => createTable(transaction, spec.name, spec.columns));\r\n\t\t\t\tp = p.then(() => createIndices(transaction, schema, spec, true));\r\n\t\t\t}\r\n\t\r\n\t\t\treturn p;\r\n\t\t}\r\n\t\t\r\n\t\tprivate loadKeyValues(transaction: DbTransaction): Promise<any> {\r\n\t\t\treturn runQuery(transaction, this.keyValueTable, {}, undefined, undefined)\r\n\t\t\t\t.then((rows: KeyValue[]) => {\r\n\t\t\t\t\tthis.keyValues = {};\r\n\t\t\t\t\trows.forEach((row: KeyValue) => {\r\n\t\t\t\t\t\tthis.keyValues[row.key] = row.value;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tgetValue(key: string): any {\r\n\t\t\treturn this.keyValues[key];\r\n\t\t}\r\n\t\t\r\n\t\tsetValue(key: string, value: any): Promise<any> {\r\n\t\t\tthis.keyValues[key] = value;\r\n\t\t\treturn this.keyValueTable.add({save: {key, value}});\r\n\t\t}\r\n\t\r\n\t\tadd<Element, Mutator>(table: Table<Element, Mutator, any>, ...changes: TableChange<Element, Mutator>[]): Promise<any> {\r\n\t\t\tverify(this.db, \"apply(): not opened\");\r\n\t\t\tlet changeTable = getChangeTableName(table.spec.name);\r\n\t\r\n\t\t\treturn this.db.transaction((transaction: DbTransaction): Promise<any> => {\r\n\t\t\t\tlet p1 = Promise.resolve();\r\n\t\t\t\tlet toResolve = new Set<KeyType>();\r\n\t\t\t\tchanges.forEach((change: TableChange<Element, Mutator>) => {\r\n\t\t\t\t\tlet time = change.time || Date.now();\r\n\t\t\t\t\tverify((change.save ? 1 : 0) + (change.change ? 1 : 0) + (change.delete ? 1 : 0) === 1, \"change (%s) must specify exactly one action at a time\", change);\r\n\t\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\t\tif (change.save) {\r\n\t\t\t\t\t\t// append internal column values\r\n\t\t\t\t\t\tlet element = assign(\r\n\t\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t\tchange.save,\r\n\t\t\t\t\t\t\t{ [internal_column_time]: time }\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tp1 = p1.then(() => insertElement(transaction, table, element));\r\n\t\t\t\t\t\ttoResolve.add(table.keyValue(element));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (change.change || change.delete) {\r\n\t\t\t\t\t\tlet changeRow: ChangeTableRow = {\r\n\t\t\t\t\t\t\tkey: null,\r\n\t\t\t\t\t\t\ttime: time,\r\n\t\t\t\t\t\t\tchange: null\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (change.change) {\r\n\t\t\t\t\t\t\t// store changes\r\n\t\t\t\t\t\t\tlet mutator = shallowCopy(change.change);\r\n\t\t\t\t\t\t\tchangeRow.key = table.keyValue(mutator);\r\n\t\t\t\t\t\t\tdelete mutator[table.key];\r\n\t\t\t\t\t\t\tchangeRow.change = serializeChange(mutator, table.spec);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// mark deleted\r\n\t\t\t\t\t\t\tchangeRow.key = change.delete;\r\n\t\t\t\t\t\t\tchangeRow.change = serializeChange(deleteRow_action, table.spec);\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t// insert into change table\r\n\t\t\t\t\t\tlet columns = Object.keys(changeRow);\r\n\t\t\t\t\t\tlet values: any[] = columns.map(k => changeRow[k]);\r\n\t\t\t\t\t\tp1 = p1.then(() => insert(transaction, changeTable, columns, values));\r\n\t\t\t\t\t\ttoResolve.add(changeRow.key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\t\t\tthrow new Error(\"no operation specified for change- should be one of save, change, or delete\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\ttoResolve.forEach((keyValue: KeyType) => {\r\n\t\t\t\t\tp1 = p1.then(() => resolve(transaction, table, keyValue));\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\treturn p1;\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\tfind<Element, Query>(table: Table<Element, any, Query>, query: Query, opts?: FindOpts): Promise<Element[]> {\r\n\t\t\treturn this.db.readTransaction((transaction: DbTransaction): Promise<any> => {\r\n\t\t\t\tlet q = assign({}, query, {\r\n\t\t\t\t\t[internal_column_deleted]: false,\r\n\t\t\t\t\t[internal_column_latest]: true,\r\n\t\t\t\t});\r\n\t\t\t\treturn runQuery(transaction, table, q, opts, table.spec.clazz);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction getChangeTableName(name: string): string {\r\n\t\treturn internal_prefix + \"changes_\" + name;\r\n\t}\r\n\t\r\n\tfunction getSetTableName(tableName: string, col: string): string {\r\n\t\treturn internal_prefix + \"set_\" + tableName + \"_\" + col;\r\n\t}\r\n\t\r\n\tfunction buildIndices(spec: TableSpecAny) {\r\n\t\tspec.indices = shallowCopy(spec.indices) || [];\r\n\t\tfor (let col in spec.columns) {\r\n\t\t\tif (spec.columns[col].isIndex) {\r\n\t\t\t\tspec.indices.push([col]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction createInternalTableSpecs(table: Table<any, any, any>): TableSpecAny[] {\r\n\t\tlet newSpec = shallowCopy(table.spec);\r\n\t\tnewSpec.columns = shallowCopy(table.spec.columns);\r\n\t\tfor (let col in internalColumn) {\r\n\t\t\tverify(!table.spec.columns[col], \"table %s cannot have reserved column name %s\", table.spec.name, col);\r\n\t\t\tnewSpec.columns[col] = internalColumn[col];\r\n\t\t}\r\n\t\tbuildIndices(newSpec);\r\n\t\treturn [newSpec, ...createSetTableSpecs(newSpec, verifyGetValue(newSpec.columns, table.key))];\r\n\t}\r\n\t\r\n\tfunction createChangeTableSpec(table: Table<any, any, any>): TableSpecAny {\r\n\t\tlet newSpec = <TableSpecAny>{\r\n\t\t\tname: getChangeTableName(table.spec.name),\r\n\t\t\tcolumns: {\r\n\t\t\t\tkey: Column.Int().Key(),\r\n\t\t\t\ttime: Column.DateTime().Key(),\r\n\t\t\t\tchange: Column.JSON(),\r\n\t\t\t}\r\n\t\t};\r\n\t\tbuildIndices(newSpec);\r\n\t\treturn newSpec;\r\n\t}\r\n\t\r\n\tfunction createSetTableSpecs(spec: TableSpecAny, keyColumn: Column): TableSpecAny[] {\r\n\t\tlet newSpecs: TableSpecAny[] = [];\r\n\t\tfor (let col in spec.columns) {\r\n\t\t\tlet column = spec.columns[col];\r\n\t\t\tif (column.type == ColumnType.set) {\r\n\t\t\t\tlet newSpec = <TableSpecAny>{\r\n\t\t\t\t\tname: getSetTableName(spec.name, col),\r\n\t\t\t\t\tcolumns: {\r\n\t\t\t\t\t\tkey: keyColumn,\r\n\t\t\t\t\t\tvalue: new Column(column.element.type).Key(),\r\n\t\t\t\t\t\ttime: Column.Int().Key()\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tbuildIndices(newSpec);\r\n\t\t\t\tnewSpecs.push(newSpec);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn newSpecs;\r\n\t}\r\n\t\r\n\tfunction tableFromSql(name: string, sql: string): TableSpecAny {\r\n\t\tlet table = <TableSpecAny>{ name: name, columns: {}, indices: [], triggers: {} };\r\n\t\tlet matches = sql.match(/\\((.*)\\)/);\r\n\t\t/* istanbul ignore else */\r\n\t\tif (matches) {\r\n\t\t\tlet pksplit: string[] = matches[1].split(/PRIMARY KEY/i);\r\n\t\t\tlet fields = pksplit[0].split(\",\");\r\n\t\t\tfor (let i = 0; i < fields.length; i++) {\r\n\t\t\t\tverify(!fields[i].match(/^\\s*(primary|foreign)\\s+key/i), \"unexpected column modifier (primary or foreign key) on %s\", fields[i]);\r\n\t\t\t\tlet quotedName = /\"(.+)\"\\s+(.*)/;\r\n\t\t\t\tlet unquotedName = /(\\w+)\\s+(.*)/;\r\n\t\t\t\tlet parts = fields[i].match(quotedName);\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (!parts) {\r\n\t\t\t\t\tparts = fields[i].match(unquotedName);\r\n\t\t\t\t}\r\n\t\t\t\tif (parts) {\r\n\t\t\t\t\ttable.columns[parts[1]] = Column.fromSql(parts[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* istanbul ignore else */\r\n\t\t\tif (pksplit.length > 1) {\r\n\t\t\t\tlet pk = pksplit[1].match(/\\((.*)\\)/);\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (pk) {\r\n\t\t\t\t\tlet keys = pk[1].split(\",\");\r\n\t\t\t\t\tfor (let i = 0; i < keys.length; i++) {\r\n\t\t\t\t\t\tlet key = keys[i].trim();\r\n\t\t\t\t\t\ttable.columns[key].isKey = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn table;\r\n\t}\r\n\t\r\n\tfunction indexFromSql(sql: string): string[] {\r\n\t\tlet regex = /\\((.*)\\)/;\r\n\t\tlet matches = regex.exec(sql);\r\n\t\tverify(matches, \"bad format on index- couldn't determine column names from sql: %s\", sql);\r\n\t\treturn matches[1].split(\",\").map((x: string) => x.trim());\r\n\t}\r\n\t\r\n\tfunction createTable(transaction: DbTransaction, name: string, columns: ColumnSet): Promise<any> {\r\n\t\tlet cols: string[] = [];\r\n\t\tlet pk: string[] = [];\r\n\t\tfor (let col in columns) {\r\n\t\t\tlet attrs: Column = columns[col];\r\n\t\t\tlet decl: string;\r\n\t\t\tswitch (attrs.type) {\r\n\t\t\t\tcase ColumnType.set:\r\n\t\t\t\t\t// ignore this column; values go into a separate table\r\n\t\t\t\t\tverify(!attrs.isKey, \"table %s cannot have a key on set column %s\", name, col);\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tdecl = col + \" \" + Column.sql(attrs);\r\n\t\t\t\t\tcols.push(decl);\r\n\t\t\t\t\tif (attrs.isKey) {\r\n\t\t\t\t\t\tpk.push(col);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tverify(pk.length, \"table %s has no keys\", name);\r\n\t\tcols.push(\"PRIMARY KEY(\" + pk.join(\", \")  + \")\");\r\n\t\treturn transaction.executeSql(\"CREATE TABLE \" + name + \" (\" + cols.join(\", \") + \")\");\r\n\t}\r\n\t\r\n\tfunction dropTable(transaction: DbTransaction, name: string): Promise<any> {\r\n\t\treturn transaction.executeSql(\"DROP TABLE \" + name);\r\n\t}\r\n\t\r\n\tfunction createIndices(transaction: DbTransaction, schema: Schema, spec: TableSpecAny, force: boolean = false): Promise<any> {\r\n\t\tlet indicesEqual = function(a: string[], b: string[]) {\r\n\t\t\tif (a.length != b.length) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\t\tif (a[i] != b[i]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\r\n\t\tlet p = Promise.resolve();\r\n\t\tlet oldIndices = (spec.name in schema) ? schema[spec.name].indices : [];\r\n\t\tlet newIndices = spec.indices;\r\n\t\tlet getIndexName = function(indices: string[]): string {\r\n\t\t\t\treturn \"index_\" + spec.name + \"__\" + indices.join(\"_\");\r\n\t\t};\r\n\t\r\n\t\toldIndices.forEach((value: string[], i: number) => {\r\n\t\t\tlet drop = true;\r\n\t\r\n\t\t\tfor (let j = 0; j < newIndices.length; j++) {\r\n\t\t\t\tif (indicesEqual(oldIndices[i], newIndices[j])) {\r\n\t\t\t\t\tdrop = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif (drop) {\r\n\t\t\t\tp = p.then(() => transaction.executeSql(\"DROP INDEX IF EXISTS \" + getIndexName(oldIndices[i])));\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\tnewIndices.forEach((value: string[], j: number) => {\r\n\t\t\tlet create = true;\r\n\t\r\n\t\t\tfor (let i = 0; i < oldIndices.length; i++) {\r\n\t\t\t\tif (indicesEqual(oldIndices[i], newIndices[j])) {\r\n\t\t\t\t\tcreate = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif (create || force) {\r\n\t\t\t\tlet index = newIndices[j];\r\n\t\t\t\tlet sql = \"CREATE INDEX IF NOT EXISTS \" + getIndexName(index) + \" ON \" + spec.name + \" (\" + index.join(\", \") + \")\";\r\n\t\t\t\tp = p.then(() => transaction.executeSql(sql));\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\treturn p;\r\n\t}\r\n\t\r\n\tfunction copyData(transaction: DbTransaction, oldName: string, newName: string, oldColumns: ColumnSet, newColumns: ColumnSet, renamedColumns: RenamedColumnSet): Promise<any> {\r\n\t\tlet oldTableColumns = Object.keys(oldColumns).filter(col => (col in newColumns) || (col in renamedColumns));\r\n\t\tlet newTableColumns = oldTableColumns.map(col => (col in renamedColumns) ? renamedColumns[col] : col);\r\n\t\tlet p2 = Promise.resolve();\r\n\t\tif (oldTableColumns.length && newTableColumns.length) {\r\n\t\t\tlet stmt = \"INSERT INTO \" + newName + \" (\" + newTableColumns.join(\", \") + \") \";\r\n\t\t\tstmt += \"SELECT \" + oldTableColumns.join(\", \") + \" FROM \" + oldName + \";\";\r\n\t\t\tp2 = transaction.executeSql(stmt);\r\n\t\t}\r\n\t\treturn p2;\r\n\t}\r\n\t\r\n\tfunction migrateChangeTable(transaction: DbTransaction, changeTableName: string, oldColumns: ColumnSet, newColumns: ColumnSet, renamedColumns: RenamedColumnSet) {\r\n\t\tlet deletedColumns = Object.keys(oldColumns).filter(col => !(col in newColumns) && !(col in renamedColumns));\r\n\t\tlet p2 = Promise.resolve();\r\n\t\tif (renamedColumns || deletedColumns) {\r\n\t\t\tp2 = p2.then(() => {\r\n\t\t\t\treturn transaction.each(\r\n\t\t\t\t\t\"SELECT \" + ROWID + \", change\"\r\n\t\t\t\t\t+ \" FROM \" + changeTableName,\r\n\t\t\t\t\t[],\r\n\t\t\t\t\t(selectChangeTransaction: DbTransaction, row: any) => {\r\n\t\t\t\t\t\tlet change = fromText(row.change);\r\n\t\t\t\t\t\tlet changed = false;\r\n\t\t\t\t\t\tfor (let oldCol in renamedColumns) {\r\n\t\t\t\t\t\t\tlet newCol = renamedColumns[oldCol];\r\n\t\t\t\t\t\t\tif (oldCol in change) {\r\n\t\t\t\t\t\t\t\tchange[newCol] = change[oldCol];\r\n\t\t\t\t\t\t\t\tdelete change[oldCol];\r\n\t\t\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let oldCol of deletedColumns) {\r\n\t\t\t\t\t\t\tif (oldCol in change) {\r\n\t\t\t\t\t\t\t\tdelete change[oldCol];\r\n\t\t\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (changed) {\r\n\t\t\t\t\t\t\tif (Object.keys(change).length) {\r\n\t\t\t\t\t\t\t\treturn selectChangeTransaction.executeSql(\r\n\t\t\t\t\t\t\t\t\t\"UPDATE \" + changeTableName\r\n\t\t\t\t\t\t\t\t\t+ \" SET change=?\"\r\n\t\t\t\t\t\t\t\t\t+ \" WHERE \" + ROWID + \"=?\",\r\n\t\t\t\t\t\t\t\t\t[toText(change), row[ROWID]]\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\treturn selectChangeTransaction.executeSql(\r\n\t\t\t\t\t\t\t\t\t\"DELETE FROM \" + changeTableName\r\n\t\t\t\t\t\t\t\t\t+ \" WHERE \" + ROWID + \"=?\",\r\n\t\t\t\t\t\t\t\t\t[row[ROWID]]\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn p2;\r\n\t}\r\n\t\r\n\tfunction verifyGetValue(element: any, field: string | number): any {\r\n\t\tverify(field in element, \"element does not contain field %s: %s\", field, element);\r\n\t\treturn element[field];\r\n\t}\r\n\t\r\n\tfunction insert(transaction: DbTransaction, tableName: string, columns: string[], values: any[]): Promise<any> {\r\n\t\tlet questionMarks = values.map(v => \"?\");\r\n\t\tverify(columns.indexOf(ROWID) == -1, \"should not insert with rowid column\");\r\n\t\treturn transaction.executeSql(\"INSERT OR REPLACE INTO \" + tableName + \" (\" + columns.join(\", \") + \") VALUES (\" + questionMarks.join(\", \") + \")\", values);\r\n\t}\r\n\t\r\n\tfunction insertElement<Element>(transaction: DbTransaction, table: Table<Element, any, any>, element: Element): Promise<any> {\r\n\t\tlet keyValue = table.keyValue(element);\r\n\t\tlet columns = selectableColumns(table.spec, element);\r\n\t\tlet values: any[] = columns.map(col => serializeValue(table.spec, col, element[col]));\r\n\t\tlet time = verifyGetValue(element, internal_column_time);\r\n\t\t\r\n\t\tlet promises: Promise<any>[] = [];\r\n\t\tpromises.push(insert(transaction, table.spec.name, columns, values));\r\n\t\t\r\n\t\t// insert set values\r\n\t\tObject.keys(table.spec.columns).forEach(function insertElementEachColumn(col: string) {\r\n\t\t\tlet column = table.spec.columns[col];\r\n\t\t\tif (column.type == ColumnType.set && (col in element)) {\r\n\t\t\t\tlet set: Set<any> = element[col];\r\n\t\t\t\tif (set.size) {\r\n\t\t\t\t\tlet setValues: any[] = [];\r\n\t\t\t\t\tlet placeholders: string[] = [];\r\n\t\t\t\t\tset.forEach((value: any) => {\r\n\t\t\t\t\t\tplaceholders.push(\"(?, ?, ?)\");\r\n\t\t\t\t\t\tsetValues.push(time, table.keyValue(element), column.element.serialize(value));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet p = transaction.executeSql(\r\n\t\t\t\t\t\t\"INSERT INTO \" + getSetTableName(table.spec.name, col)\r\n\t\t\t\t\t\t+ \" (time, key, value)\"\r\n\t\t\t\t\t\t+ \" VALUES \" + placeholders.join(\", \")\r\n\t\t\t\t\t\t, setValues);\r\n\t\t\t\t\tpromises.push(p);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn Promise.all(promises);\r\n\t}\r\n\t\r\n\tfunction resolve<Element>(transaction: DbTransaction, table: Table<Element, any, any>, keyValue: KeyType): Promise<any> {\r\n\t\treturn selectBaseline(transaction, table, keyValue).then(function resolveSelectBaselineCallback(baseline: BaselineInfo<Element>) {\r\n\t\t\treturn getChanges(transaction, table, baseline).then(function resolveGetChangesCallback(changes: ChangeTableRow[]) {\r\n\t\t\t\tlet mutation = applyChanges(baseline, changes, table.spec);\r\n\t\t\t\tlet promises: Promise<any>[] = [];\r\n\t\t\t\tif (!mutation.isChanged) {\r\n\t\t\t\t\t// mark it as latest (and others as not)\r\n\t\t\t\t\treturn setLatest(transaction, table, keyValue, baseline.rowid);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// invalidate old latest rows\r\n\t\t\t\t\t// insert new latest row\r\n\t\t\t\t\tlet element = mutate(mutation.element, {\r\n\t\t\t\t\t\t[internal_column_latest]: {$set: true},\r\n\t\t\t\t\t\t[internal_column_time]: {$set: mutation.time},\r\n\t\t\t\t\t\t[internal_column_composed]: {$set: true}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn Promise.resolve()\r\n\t\t\t\t\t\t.then(() => invalidateLatest(transaction, table, keyValue))\r\n\t\t\t\t\t\t.then(() => insertElement(transaction, table, element));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction runQuery<Element, Query>(transaction: DbTransaction, table: Table<Element, any, Query>, query: Query, opts: FindOpts, clazz: new (props: Element) => Element): Promise<Element[]> {\r\n\t\topts = opts || {};\r\n\t\r\n\t\tconst numericConditions = {\r\n\t\t\t$gt: \">\",\r\n\t\t\t$gte: \">=\",\r\n\t\t\t$lt: \"<\",\r\n\t\t\t$lte: \"<=\"\r\n\t\t};\r\n\t\r\n\t\tconst inCondition = keyOf({ $in: false });\r\n\t\tconst hasCondition = keyOf({ $has: false });\r\n\t\tconst hasAnyCondition = keyOf({ $hasAny: false });\r\n\t\tconst hasAllConditions = keyOf({ $hasAll: false });\r\n\t\r\n\t\tlet conditions: string[] = [];\r\n\t\tlet values: (string | number)[] = [];\r\n\t\r\n\t\tObject.keys(query).forEach((col: string) => {\r\n\t\t\tverify((col in table.spec.columns) || (col in internalColumn), \"attempting to query based on column '%s' not in schema (%s)\", col, table.spec.columns);\r\n\t\t\tlet column: Column = (col in internalColumn) ? internalColumn[col] : table.spec.columns[col];\r\n\t\t\tlet spec = query[col];\r\n\t\t\tlet found = false;\r\n\t\r\n\t\t\tfor (let condition in numericConditions) {\r\n\t\t\t\tif (hasOwnProperty.call(spec, condition)) {\r\n\t\t\t\t\tconditions.push(\"(\" + col + numericConditions[condition] + \"?)\");\r\n\t\t\t\t\tlet value = spec[condition];\r\n\t\t\t\t\tverify(parseInt(value, 10) == value, \"condition %s must have a numeric argument: %s\", condition, value);\r\n\t\t\t\t\tvalues.push(value);\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!found) {\r\n\t\t\t\tif (hasOwnProperty.call(spec, inCondition)) {\r\n\t\t\t\t\tverify(Array.isArray(spec[inCondition]), \"must be an array: %s\", spec[inCondition]);\r\n\t\t\t\t\tconditions.push(col + \" IN (\" + spec[inCondition].map((x: any) => \"?\").join(\", \") + \")\");\r\n\t\t\t\t\tlet inValues: any[] = spec[inCondition];\r\n\t\t\t\t\tinValues = inValues.map(val => column.serialize(val));\r\n\t\t\t\t\tvalues.push(...inValues);\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!found) {\r\n\t\t\t\tlet has = hasOwnProperty.call(spec, hasCondition);\r\n\t\t\t\tlet hasAny = hasOwnProperty.call(spec, hasAnyCondition);\r\n\t\t\t\tlet hasAll = hasOwnProperty.call(spec, hasAllConditions);\r\n\t\t\t\tif (has || hasAny || hasAll) {\r\n\t\t\t\t\tlet existsSetValues = function(setValues: any[], args: (string | number)[]): string {\r\n\t\t\t\t\t\tlet escapedValues = setValues.map(value => column.element.serialize(value));\r\n\t\t\t\t\t\targs.push(...escapedValues);\r\n\t\t\t\t\t\treturn \"EXISTS (\"\r\n\t\t\t\t\t\t\t+ \"SELECT 1 FROM \" + getSetTableName(table.spec.name, col)\r\n\t\t\t\t\t\t\t+ \" WHERE value IN (\" + setValues.map(x => \"?\").join(\", \") + \")\"\r\n\t\t\t\t\t\t\t+ \" AND key=\" + table.spec.name + \".\" + table.key\r\n\t\t\t\t\t\t\t+ \" AND time=\" + table.spec.name + \".\" + internal_column_time\r\n\t\t\t\t\t\t\t+ \")\";\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\t\tif (has) {\r\n\t\t\t\t\t\tlet hasValue = spec[hasCondition];\r\n\t\t\t\t\t\tverify(!Array.isArray(hasValue), \"must not be an array: %s\", hasValue);\r\n\t\t\t\t\t\tlet condition = existsSetValues([hasValue], values);\r\n\t\t\t\t\t\tconditions.push(condition);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (hasAny) {\r\n\t\t\t\t\t\tlet hasAnyValues: any[] = spec[hasAnyCondition];\r\n\t\t\t\t\t\tverify(Array.isArray(hasAnyValues), \"must be an array: %s\", hasAnyValues);\r\n\t\t\t\t\t\tlet condition = existsSetValues(hasAnyValues, values);\r\n\t\t\t\t\t\tconditions.push(condition);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (hasAll) {\r\n\t\t\t\t\t\tlet hasAllValues: any[] = spec[hasAllConditions];\r\n\t\t\t\t\t\tverify(Array.isArray(hasAllValues), \"must be an array: %s\", hasAllValues);\r\n\t\t\t\t\t\tfor (let hasValue of hasAllValues) {\r\n\t\t\t\t\t\t\tlet condition = existsSetValues([hasValue], values);\r\n\t\t\t\t\t\t\tconditions.push(condition);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!found) {\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (column.type == ColumnType.bool) {\r\n\t\t\t\t\tconditions.push(col + (spec ? \"!=0\" : \"=0\"));\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof spec === \"number\" || typeof spec === \"string\") {\r\n\t\t\t\t\tconditions.push(\"(\" + col + \"=?)\");\r\n\t\t\t\t\tvalues.push(spec);\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\t\t\telse if (spec instanceof RegExp) {\r\n\t\t\t\t\tlet rx: RegExp = spec;\r\n\t\t\t\t\tlet arg = rx.source.replace(/\\.\\*/g, \"%\").replace(/\\./g, \"_\");\r\n\t\t\t\t\tif (arg[0] == \"^\") {\r\n\t\t\t\t\t\targ = arg.substring(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\targ = \"%\" + arg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (arg[arg.length - 1] == \"$\") {\r\n\t\t\t\t\t\targ = arg.substring(0, arg.length - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\targ = arg + \"%\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tverify(!arg.match(/(\\$|\\^|\\*|\\.|\\(|\\)|\\[|\\]|\\?)/), \"RegExp search only supports simple wildcards (.* and .): %s\", arg);\r\n\t\t\t\t\tconditions.push(\"(\" + col + \" LIKE ?)\");\r\n\t\t\t\t\tvalues.push(arg);\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tverify(found, \"unknown query condition for %s: %s\", col, spec);\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\tlet fields: FieldSpec = assign({}, opts.fields || table.spec.columns, {[internal_column_time]: true});\r\n\t\tlet columns: string[] = selectableColumns(table.spec, fields);\r\n\t\tlet stmt = \"SELECT \" + (opts.count ? COUNT : columns.join(\", \"));\r\n\t\tstmt += \" FROM \" + table.spec.name;\r\n\t\tif (conditions.length) {\r\n\t\t\tstmt += \" WHERE \" + conditions.join(\" AND \");\r\n\t\t}\r\n\t\r\n\t\tif (opts.orderBy) {\r\n\t\t\tlet col = keyOf(opts.orderBy);\r\n\t\t\tlet order = opts.orderBy[col];\r\n\t\t\tstmt += \" ORDER BY \" + col + \" \" + (order == OrderBy.ASC ? \"ASC\" : \"DESC\");\r\n\t\t}\r\n\t\r\n\t\tif (opts.limit) {\r\n\t\t\tstmt += \" LIMIT \" + opts.limit;\r\n\t\t}\r\n\t\r\n\t\tif (opts.offset) {\r\n\t\t\tstmt += \" OFFSET \" + opts.offset;\r\n\t\t}\r\n\t\r\n\t\treturn transaction.executeSql(stmt, values, (tx2: DbTransaction, rows: any[]) => {\r\n\t\t\tif (opts.count) {\r\n\t\t\t\tlet count = parseInt(rows[0][COUNT], 10);\r\n\t\t\t\treturn count;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet promises = rows.map((element: Element) => loadExternals(transaction, table, element, opts.fields));\r\n\t\t\t\treturn Promise.all(promises)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tlet results: Element[] = [];\r\n\t\t\t\t\t\tfor (let i = 0; i < rows.length; i++) {\r\n\t\t\t\t\t\t\tlet row = deserializeRow<Element>(table.spec, rows[i]);\r\n\t\t\t\t\t\t\tfor (let col in internalColumn) {\r\n\t\t\t\t\t\t\t\tif (!opts.fields || !(col in opts.fields)) {\r\n\t\t\t\t\t\t\t\t\tdelete row[col];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet obj = clazz ? new clazz(row) : row;\r\n\t\t\t\t\t\t\tresults.push(obj);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn results;\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction popValue<Element>(element: Element, field: string) {\r\n\t\tlet ret = verifyGetValue(element, field);\r\n\t\tdelete element[field];\r\n\t\treturn ret;\r\n\t}\r\n\t\r\n\tfunction selectBaseline<Element, Query>(transaction: DbTransaction, table: Table<Element, any, any>, keyValue: KeyType): Promise<BaselineInfo<Element>> {\r\n\t\tlet fieldSpec = <FieldSpec>{\r\n\t\t\t[ROWID]: true,\r\n\t\t\t[internal_column_time]: true,\r\n\t\t\t[internal_column_deleted]: true,\r\n\t\t};\r\n\t\tObject.keys(table.spec.columns).forEach(col => fieldSpec[col] = true);\r\n\t\r\n\t\tlet query = <Query>{\r\n\t\t\t[table.key]: keyValue,\r\n\t\t\t[internal_column_composed]: false\r\n\t\t};\r\n\t\r\n\t\tlet opts = <FindOpts>{\r\n\t\t\tfields: fieldSpec,\r\n\t\t\torderBy: { [internal_column_time]: OrderBy.DESC },\r\n\t\t\tlimit: 1\r\n\t\t};\r\n\t\r\n\t\treturn runQuery(transaction, table, query, opts, null)\r\n\t\t\t.then((baselineResults: any[]) => {\r\n\t\t\t\tlet baseline: BaselineInfo<Element> = {\r\n\t\t\t\t\telement: <Element>{},\r\n\t\t\t\t\ttime: 0,\r\n\t\t\t\t\trowid: -1\r\n\t\t\t\t};\r\n\t\t\t\tif (baselineResults.length) {\r\n\t\t\t\t\tlet element = <Element>baselineResults[0];\r\n\t\t\t\t\tbaseline.element = element;\r\n\t\t\t\t\tbaseline.time = popValue(element, internal_column_time);\r\n\t\t\t\t\tbaseline.rowid = popValue(element, ROWID);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tbaseline.element[table.key] = keyValue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn baseline;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tfunction loadExternals<Element>(transaction: DbTransaction, table: Table<Element, any, any>, element: any, fields: FieldSpec): Promise<any> {\r\n\t\tlet promises: Promise<any>[] = [];\r\n\t\tObject.keys(table.spec.columns).forEach(function loadExternalsForEach(col: string) {\r\n\t\t\tif (!fields || (col in fields && fields[col])) {\r\n\t\t\t\tlet column = table.spec.columns[col];\r\n\t\t\t\tif (column.type == ColumnType.set) {\r\n\t\t\t\t\tlet set: Set<any> = element[col] = element[col] || new Set<any>();\r\n\t\t\t\t\tlet keyValue = verifyGetValue(element, table.key);\r\n\t\t\t\t\tlet time = verifyGetValue(element, internal_column_time);\r\n\t\t\t\t\tlet p = transaction.executeSql(\r\n\t\t\t\t\t\t\"SELECT value \"\r\n\t\t\t\t\t\t+ \"FROM \" + getSetTableName(table.spec.name, col)\r\n\t\t\t\t\t\t+ \" WHERE key=?\"\r\n\t\t\t\t\t\t+ \" AND time=?\",\r\n\t\t\t\t\t\t[keyValue, time],\r\n\t\t\t\t\t\tfunction loadExternalsSqlCallback(tx: DbTransaction, results: SetTableRow[]) {\r\n\t\t\t\t\t\t\tfor (let row of results) {\r\n\t\t\t\t\t\t\t\tset.add(column.element.deserialize(row.value));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t\tpromises.push(p);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Promise.all(promises);\r\n\t}\r\n\t\r\n\tfunction getChanges<Element>(transaction: DbTransaction, table: Table<Element, any, any>, baseline: BaselineInfo<Element>): Promise<ChangeTableRow[]> {\r\n\t\tlet keyValue = verifyGetValue(baseline.element, table.key);\r\n\t\treturn transaction.executeSql(\r\n\t\t\t\"SELECT key, time, change\"\r\n\t\t\t+ \" FROM \" + getChangeTableName(table.spec.name)\r\n\t\t\t+ \" WHERE key=? AND time>=?\"\r\n\t\t\t+ \" ORDER BY time ASC\",\r\n\t\t\t[keyValue, baseline.time]);\r\n\t}\r\n\t\r\n\tinterface MutationResult<Element> {\r\n\t\telement: Element;\r\n\t\ttime: number;\r\n\t\tisChanged: boolean;\r\n\t}\r\n\t\r\n\tfunction applyChanges<Element, Mutator>(baseline: BaselineInfo<Element>, changes: ChangeTableRow[], spec: TableSpecAny): MutationResult<Element> {\r\n\t\tlet element: Element = baseline.element;\r\n\t\tlet time = baseline.time;\r\n\t\tfor (let i = 0; i < changes.length; i++) {\r\n\t\t\tlet row = changes[i];\r\n\t\t\tlet mutator = <Mutator>deserializeChange(row.change, spec);\r\n\t\t\telement = mutate(element, mutator);\r\n\t\t\ttime = Math.max(time, row.time);\r\n\t\t}\r\n\t\tlet isChanged = isMutated(baseline.element, element) || baseline.rowid == -1;\r\n\t\treturn { element, time, isChanged };\r\n\t}\r\n\t\r\n\tfunction setLatest<Element>(transaction: DbTransaction, table: Table<Element, any, any>, keyValue: KeyType, rowid: number): Promise<any> {\r\n\t\treturn transaction.executeSql(\r\n\t\t\t\"UPDATE \" + table.spec.name\r\n\t\t\t+ \" SET \" + internal_column_latest + \"=(\" + ROWID + \"=\" + rowid + \")\"\r\n\t\t\t+ \" WHERE \" + table.key + \"=?\",\r\n\t\t\t[keyValue]);\r\n\t}\r\n\t\r\n\tfunction invalidateLatest<Element>(transaction: DbTransaction, table: Table<Element, any, any>, keyValue: KeyType): Promise<any> {\r\n\t\treturn transaction.executeSql(\r\n\t\t\t\"UPDATE \" + table.spec.name\r\n\t\t\t+ \" SET \" + internal_column_latest + \"=0\"\r\n\t\t\t+ \" WHERE \" + table.key + \"=?\",\r\n\t\t\t[keyValue]);\r\n\t}\r\n\t\r\n\tfunction selectableColumns(spec: TableSpecAny, cols: { [key: string]: any }): string[] {\r\n\t\treturn Object.keys(cols).filter(col => (col == ROWID) || (col in internalColumn) || ((col in spec.columns) && (spec.columns[col].type != ColumnType.set)));\r\n\t}\r\n\t\r\n\tfunction serializeValue(spec: TableSpecAny, col: string, value: any): Serializable {\r\n\t\tif (col in spec.columns) {\r\n\t\t\tlet x = spec.columns[col].serialize(value);\r\n\t\t\treturn x;\r\n\t\t}\r\n\t\tverify(typeof value == \"number\" || value, \"bad value\");\r\n\t\treturn value;\r\n\t}\r\n\t\r\n\tfunction deserializeValue(spec: TableSpecAny, col: string, value: any) {\r\n\t\tif (col in spec.columns) {\r\n\t\t\tvalue = spec.columns[col].deserialize(value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\t\r\n\tlet setKey = keyOf({ $set: false });\r\n\tfunction serializeChange<Mutator>(change: Mutator, spec: TableSpec<any, Mutator, any>): string {\r\n\t\tfor (let col in change) {\r\n\t\t\tlet val = change[col];\r\n\t\t\tif (hasOwnProperty.call(val, setKey)) {\r\n\t\t\t\tchange[col] = shallowCopy(change[col]);\r\n\t\t\t\tchange[col][setKey] = serializeValue(spec, col, change[col][setKey]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn toText(change);\r\n\t}\r\n\t\r\n\tfunction deserializeChange<Mutator>(text: string, spec: TableSpec<any, Mutator, any>): Mutator {\r\n\t\tlet change = fromText(text);\r\n\t\tfor (let col in change) {\r\n\t\t\tlet val = change[col];\r\n\t\t\tif (hasOwnProperty.call(val, setKey)) {\r\n\t\t\t\tchange[col][setKey] = deserializeValue(spec, col, change[col][setKey]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn change;\r\n\t}\r\n\t\r\n\tfunction deserializeRow<T>(spec: TableSpecAny, row: any[]): T {\r\n\t\tlet ret: T = <any>{};\r\n\t\tfor (let col in row) {\r\n\t\t\tlet src = row[col];\r\n\t\t\tif (src != null) {\r\n\t\t\t\tret[col] = deserializeValue(spec, col, src);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\t\r\n\t\r\n\texport function createStore(params: CreateStoreParams): Store {\r\n\t\treturn new Store(params);\r\n\t}\r\n}\r\n","///<reference path=\"./Store\"/>\r\n\"use strict\";\r\n\r\n/* istanbul ignore else */\r\nif (typeof module !== \"undefined\") {\r\n\tmodule.exports = Updraft;\r\n}\r\n","\"use strict\";\r\n\r\nnamespace Updraft.Query {\r\n\texport interface NumericConditions {\r\n\t\t$gt?: number;\r\n\t\t$gte?: number;\r\n\t\t$lt?: number;\r\n\t\t$lte?: number;\r\n\t}\r\n\t\r\n\texport interface SetHasCondition<T> {\r\n\t\t$has?: T;\r\n\t}\r\n\r\n\texport interface SetHasAnyCondition<T> {\r\n\t\t$hasAny?: T[];\r\n\t}\r\n\r\n\texport interface SetHasAllConditions<T> {\r\n\t\t$hasAll?: T[];\r\n\t}\r\n\t\r\n\texport interface DateConditions {\r\n\t\t$after?: Date;\r\n\t\t$before?: Date;\r\n\t}\r\n\t\r\n\texport interface InCondition<T> {\r\n\t\t$in: T[];\r\n\t}\r\n\t\r\n\texport type primitive<T> = T | InCondition<T>;\r\n\r\n\texport type none = void;\r\n\texport type bool = boolean;\r\n\texport type num = primitive<number> | NumericConditions;\r\n\texport type str = primitive<string> | RegExp;\r\n\texport type date = primitive<Date> | DateConditions;\r\n\texport type enm<T> = primitive<T>;\r\n\texport type set<T> = SetHasCondition<T> | SetHasAnyCondition<T> | SetHasAllConditions<T>;\r\n\texport type strSet = set<string>;\r\n}\r\n","///<reference path=\"../typings/tsd.d.ts\"/>\r\n///<reference path=\"./Database\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n\t// compatible with sqlite3\r\n\texport interface IDatabase {\r\n\t\trun(sql: string, callback?: (err: Error) => void): IDatabase;\r\n\t\tall(sql: string, params?: any[], callback?: (err: Error, rows: any[]) => void): IDatabase;\r\n\t\teach(sql: string, params?: any[], callback?: (err: Error, row: any) => void, complete?: (err: Error, count: number) => void): IDatabase;\r\n\t\tserialize(callback?: () => void): void;\r\n\t\tparallelize(callback?: () => void): void;\r\n\t}\r\n\t\r\n\t\r\n\tclass SQLiteWrapper implements DbWrapper {\r\n\t\tprivate db: IDatabase;\r\n\t\r\n\t\tconstructor(db: IDatabase) {\r\n\t\t\tthis.db = db;\r\n\t\t}\r\n\t\r\n\t\trun(sql: string): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.db.run(sql, (err: Error) => {\r\n\t\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.log(\"SQLiteWrapper.run(): error executing '\" + sql + \"': \", err);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\tall(tx: DbTransaction, sql: string, params?: (string | number)[], callback?: DbResultsCallback): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.db.all(sql, params, (err: Error, rows: any[]) => {\r\n\t\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.log(\"SQLiteWrapper.all(): error executing '\" + sql + \"': \", err);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\t\tresolve(callback(tx, rows));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresolve(rows);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\teach(tx: DbTransaction, sql: string, params: (string | number)[], callback: DbEachResultCallback): Promise<any> {\r\n\t\t\tlet p: any = undefined;\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.db.each(sql, params, (err: Error, row: any) => {\r\n\t\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.log(\"SQLiteWrapper.each(): error executing '\" + sql + \"': \", err);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tp = callback(tx, row);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t(err: Error, count: number) => {\r\n\t\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.log(\"SQLiteWrapper.each(): error executing '\" + sql + \"': \", err);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tresolve(p);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\ttransaction(callback: DbTransactionCallback): Promise<any> {\r\n\t\t\tlet result: any = undefined;\r\n\t\t\treturn Promise.resolve()\r\n\t\t\t\t.then(() => this.run(\"BEGIN TRANSACTION\"))\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tlet tx: DbTransaction = {\r\n\t\t\t\t\t\texecuteSql: (sql: string, params?: (string | number)[], resultsCb?: DbResultsCallback): Promise<any> => {\r\n\t\t\t\t\t\t\treturn this.all(tx, sql, params, resultsCb);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\teach: (sql: string, params?: (string | number)[], resultsCb?: DbEachResultCallback): Promise<any> => {\r\n\t\t\t\t\t\t\treturn this.each(tx, sql, params, resultsCb);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn callback(tx);\r\n\t\t\t\t})\r\n\t\t\t\t.then((ret) => result = ret)\r\n\t\t\t\t.then(() => this.run(\"COMMIT TRANSACTION\"))\r\n\t\t\t\t.then(() => result)\r\n\t\t\t\t.catch(/* istanbul ignore next */ (err: Error) => {\r\n\t\t\t\t\tconsole.log(\"encountered error, rolling back transaction: \", err);\r\n\t\t\t\t\tthis.run(\"ROLLBACK TRANSACTION\");\r\n\t\t\t\t\tthrow err;\r\n\t\t\t\t})\r\n\t\t\t;\r\n\t\t}\r\n\t\r\n\t\treadTransaction(callback: DbTransactionCallback): Promise<any> {\r\n\t\t\treturn this.transaction(callback);\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\texport function createSQLiteWrapper(db: IDatabase): DbWrapper {\r\n\t\t\treturn new SQLiteWrapper(db);\r\n\t}\r\n}\r\n","///<reference path=\"./websql.d.ts\"/>\r\n///<reference path=\"./Database\"/>\r\n\"use strict\";\r\n\r\nnamespace Updraft {\r\n\r\n\tinterface WebsqlTransaction extends DbTransaction {\r\n\t\trealTransaction: SQLTransaction;\r\n\t}\r\n\t\r\n\t\r\n\t/* istanbul ignore next: can't test websql in node */\r\n\tclass WebsqlWrapper implements DbWrapper {\r\n\t\tdb: Database;\r\n\t\ttraceCallback: (trace: string) => any;\r\n\t\r\n\t\tconstructor(name: string, version?: string, displayName?: string, estimatedSize?: number, traceCallback?: (trace: string) => any) {\r\n\t\t\tversion = version || \"1.0\";\r\n\t\t\tdisplayName = displayName || name;\r\n\t\t\testimatedSize = estimatedSize || 5 * 1024 * 1024;\r\n\t\r\n\t\t\tthis.db = window.openDatabase(name, version, displayName, estimatedSize);\r\n\t\t\tthis.traceCallback = traceCallback;\r\n\t\t}\r\n\t\t\r\n\t\ttrace(sql: string, params?: (string | number)[]) {\r\n\t\t\tif (this.traceCallback) {\r\n\t\t\t\tlet escapedString = this.stringify(sql, params);\r\n\t\t\t\tthis.traceCallback(escapedString);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tstringify(sql: string, params?: (string | number)[]): string {\r\n\t\t\tlet idx: number = 0;\r\n\t\t\tlet escapedString = sql.replace(/\\?/g, () => {\r\n\t\t\t\tlet x = params[idx++];\r\n\t\t\t\tif (typeof x == \"number\") {\r\n\t\t\t\t\treturn <string>x;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"'\" + x + \"'\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn escapedString;\r\n\t\t}\r\n\t\r\n\t\tall(tx: WebsqlTransaction, sql: string, params?: (string | number)[], callback?: DbResultsCallback): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.trace(sql, params);\r\n\t\t\t\ttx.realTransaction.executeSql(sql, params,\r\n\t\t\t\t\t(transaction: SQLTransaction, resultSet: SQLResultSet) => {\r\n\t\t\t\t\t\tlet results: any[] = [];\r\n\t\t\t\t\t\tfor (let i = 0; i < resultSet.rows.length; i++) {\r\n\t\t\t\t\t\t\tlet row = resultSet.rows.item(i);\r\n\t\t\t\t\t\t\tresults.push(row);\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\t\tresolve(callback(this.wrapTransaction(transaction), results));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tresolve(results);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t(transaction: SQLTransaction, error: SQLError) => {\r\n\t\t\t\t\t\tconsole.error(\"error executing '\" + this.stringify(sql, params) + \"': \", error);\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\teach(tx: WebsqlTransaction, sql: string, params?: (string | number)[], callback?: DbEachResultCallback): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.trace(sql, params);\r\n\t\t\t\ttx.realTransaction.executeSql(sql, params,\r\n\t\t\t\t\t(transaction: SQLTransaction, resultSet: SQLResultSet) => {\r\n\t\t\t\t\t\tlet p = Promise.resolve();\r\n\t\t\t\t\t\tfor (let i = 0; i < resultSet.rows.length; i++) {\r\n\t\t\t\t\t\t\tlet row = resultSet.rows.item(i);\r\n\t\t\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\t\t\t(function(row: any) {\r\n\t\t\t\t\t\t\t\t\tp = p.then(() => callback(tx, row));\r\n\t\t\t\t\t\t\t\t})(row);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tresolve(p);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t(transaction: SQLTransaction, error: SQLError) => {\r\n\t\t\t\t\t\tconsole.error(\"error executing '\" + this.stringify(sql, params) + \"': \", error);\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\tprivate wrapTransaction(transaction: SQLTransaction): WebsqlTransaction {\r\n\t\t\tlet tx: WebsqlTransaction = {\r\n\t\t\t\trealTransaction: transaction,\r\n\t\t\t\texecuteSql: (sql: string, params?: (string | number)[], callback?: DbResultsCallback): Promise<any> => {\r\n\t\t\t\t\treturn this.all(tx, sql, params, callback);\r\n\t\t\t\t},\r\n\t\t\t\teach: (sql: string, params?: (string | number)[], callback?: DbEachResultCallback): Promise<any> => {\r\n\t\t\t\t\treturn this.each(tx, sql, params, callback);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn tx;\r\n\t\t}\r\n\t\r\n\t\ttransaction(callback: DbTransactionCallback): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.db.transaction((transaction: SQLTransaction) => {\r\n\t\t\t\t\tlet tx = this.wrapTransaction(transaction);\r\n\t\t\t\t\tresolve(callback(tx));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\treadTransaction(callback: DbTransactionCallback): Promise<any> {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.db.readTransaction((transaction: SQLTransaction) => {\r\n\t\t\t\t\tlet tx = this.wrapTransaction(transaction);\r\n\t\t\t\t\tresolve(callback(tx));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/* istanbul ignore next: can't test websql in node */\r\n\texport function createWebsqlWrapper(name: string, version?: string, displayName?: string, estimatedSize?: number, traceCallback?: (trace: string) => any): DbWrapper {\r\n\t\t\treturn new WebsqlWrapper(name, version, displayName, estimatedSize, traceCallback);\r\n\t}\r\n}\r\n"],"sourceRoot":"/source/"}